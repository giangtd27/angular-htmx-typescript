<!-- HTMX view template for user form -->
<div class="form-overlay" hx-on::htmx:after-swap="closeDialog()">
  <div class="form-container" hx-on::click="event.stopPropagation()">
    <div class="form-header">
      <h2>{{ isEdit ? 'Edit User' : 'Create User' }}</h2>
      <button 
        class="btn-close" 
        hx-get="/api/users/list"
        hx-target="#dialog-container"
        hx-swap="outerHTML"
        type="button">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="currentColor"/>
        </svg>
      </button>
    </div>

    <form 
      hx-post="{{ isEdit ? '/api/users/' + userId + '/update' : '/api/users/create' }}"
      hx-target="#users-list"
      hx-swap="innerHTML"
      hx-indicator="#loading"
      class="form-body">
      
      @if (error) {
        <div class="error-message">
          {{ error }}
        </div>
      }

      <div class="form-group">
        <label for="name">Name *</label>
        <input
          type="text"
          id="name"
          name="name"
          value="{{ user?.name || '' }}"
          required
          placeholder="Enter user name"
        />
      </div>

      <div class="form-group">
        <label for="email">Email *</label>
        <input
          type="email"
          id="email"
          name="email"
          value="{{ user?.email || '' }}"
          required
          placeholder="Enter user email"
        />
      </div>

      <div class="form-group">
        <label for="role">Role</label>
        <select id="role" name="role">
          @for (role of roles; track role) {
            <option value="{{ role }}" [selected]="user?.role === role">
              {{ getRoleLabel(role) }}
            </option>
          }
        </select>
      </div>

      <div class="form-footer">
        <button 
          type="button" 
          class="btn btn-secondary" 
          hx-get="/api/users/list"
          hx-target="#dialog-container"
          hx-swap="outerHTML">
          Cancel
        </button>
        <button type="submit" class="btn btn-primary">
          {{ isEdit ? 'Update' : 'Create' }}
        </button>
      </div>
    </form>
  </div>
</div>

